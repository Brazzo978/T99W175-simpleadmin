#!/bin/bash
set -eu

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
# shellcheck source=/dev/null
. "$SCRIPT_DIR/../session_utils.sh"

phone_number="${1:-}"
message_encoded="${2:-}"

if [ -z "$phone_number" ] || [ -z "$message_encoded" ]; then
    send_json_response 400 '{"success":false,"message":"Missing phone number or message"}'
    exit 0
fi

escaped_number=$(json_escape "$phone_number")
escaped_message=$(json_escape "$message_encoded")

payload=$(printf '{\n  "success":false,\n  "message":"Quectel modem logic placeholder: implement SMS transport and parsing here.",\n  "logic":"quectel",\n  "implemented":false,\n  "number":"%s",\n  "message_encoded":"%s"\n}\n' "$escaped_number" "$escaped_message")

send_json_response 501 "$payload"
